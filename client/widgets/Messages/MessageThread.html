<template name="MessageThread">
    {{> Message this}}
        {{#if this.discussion_root_sign_id}}
            <div class="message-thread-link-to-discussion-head">
                <a href="/discussion/sign/{{this.discussion_root_sign_id}}">
                    See whole discussion
                </a>
            </div>
        {{/if}}
    {{#each responsesOfSign this}}
        {{> Message this}}
    {{/each}}
</template>

<template name="SingleMessageThread">
    <div class="message-thread-header">
        <div class="google-maps-background"></div>
        {{> Message this}}
    </div>
    {{#if this.discussion_root_sign_id}}
        <div class="message-thread-link-to-discussion-head">
            <a href="/discussion/sign/{{this.discussion_root_sign_id}}">
                See whole discussion
            </a>
        </div>
    {{/if}}
    {{#each responsesOfSign this}}
        {{> Message this}}
    {{/each}}
</template>

<template name="Message">
    <article class="messages-message">
        <header>
            <div class="messages-message-head">
                {{#if avatar}}
                    <img class="messages-message-avatar-pic" src="/static/resource/{{avatar}}" width="80" height="80">
                {{/if}}
                {{#if poster_id}}
                    <a class="messages-message-username" href="/{{username}}">{{username}}</a>
                {{/if}}
                {{#unless poster_id}}
                    <span class="messages-message-username">{{username}}</span>
                {{/unless}}
            </div>
        </header>
        <div class="messages-message-body">
            {{FormatMessage this}}
        </div>
        <div class="messages-message-attached-content">
            {{#if ownsAttachedContent this}}
                <hr>
            {{/if}}
            {{attachedContent this}}
        </div>
        <footer>
            <div class="messages-message-actions">
                <a class="link-to-sign" href="/{{username}}/sign/{{_id}}"><i class="fa fa-link"></i></a>
                <button value="{{this._id}}" class="js-show-response-form messages-messages-actions-reply"><i
                        class="fa fa-reply"></i></button>
            </div>
            {{#if isRespondingTo this}}
                {{> NewMessageForm this}}
            {{/if}}
        </footer>
    </article>
</template>